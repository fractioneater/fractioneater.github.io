{
  "name": "Flicker",
  "scopeName": "source.flicker",
  "fileTypes": [
    "fl",
    "flicker"
  ],

  "patterns": [
    { "include": "#comment" },
    { "include": "#block-comment" },
    { "include": "#string" },
    { "include": "#lambda" },
    { "include": "#keyword" },
    { "include": "#keyword-loop" },
    { "include": "#use" },
    { "include": "#constant" },
    { "include": "#variable" },
    { "include": "#type" },
    { "include": "#modifier" },
    { "include": "#declaration" },
    { "include": "#function" },
    { "include": "#call" },
    { "include": "#method-call" },
    { "include": "#callable" },
    { "include": "#class" }
  ],
  "repository": {
    "comment": {
      "name": "comment.line.number-sign.flicker",
      "match": "#(?!:).*\\n?"
    },
    "block-comment": {
      "name": "comment.block.flicker",
      "begin": "#:",
      "end": "#",
      "patterns": [ { "include": "#block-comment" } ]
    },
    "string": {
      "name": "string.quoted.double.flicker",
      "begin": "\"",
      "beginCaptures": {
        "0": {
          "name": "punctuation.definition.string.begin.flicker"
        }
      },
      "end": "\"",
      "endCaptures": {
        "0": {
          "name": "punctuation.definition.string.end.flicker"
        }
      },
      "patterns": [
        { "include": "#string-escapes" }
      ]
    },
    "string-escapes": {
      "patterns": [
        {
          "name": "constant.character.escape.flicker",
          "match": "\\\\(?:[\"\\\\=0abefnrtv]|x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})"
        },
        {
          "name": "invalid.illegal.unknown-escape.flicker",
          "match": "\\\\(?:x[0-9A-Fa-f]{0,1}|u[0-9A-Fa-f]{0,3}|U[0-9A-Fa-f]{0,7}|.)"
        },
        {
          "name": "constant.character.interpolation.flicker",
          "match": "=\\((.*?)\\)"
        }
      ]
    },
    "semicolon": {
      "name": "invalid.deprecated.semicolon.flicker",
      "match": "\\;$"
    },
    "lambda": {
      "begin": "{",
      "beginCaptures": {
        "0": {
          "name": "punctuation.section.lambda.begin.flicker"
        }
      },
      "end": "}",
      "endCaptures": {
        "0": {
          "name": "punctuation.section.lambda.end.flicker"
        }
      },
      "name": "meta.lambda.flicker",
      "patterns": [
        {
          "name": "meta.lambda.parameters.flicker",
          "begin": "\\|",
          "end": "\\|",
          "captures": {
            "0": { "name": "punctuation.terminator.parameters.flicker" }
          },
          "patterns": [
            {
              "name": "variable.parameter.lambda.flicker",
              "match": "\\w+"
            }
          ]
        },
        { "include": "#comment" },
        { "include": "#block-comment" },
        { "include": "#string" },
        { "include": "#lambda" },
        { "include": "#keyword" },
        { "include": "#keyword-loop" },
        { "include": "#use" },
        { "include": "#constant" },
        { "include": "#variable" },
        { "include": "#type" },
        { "include": "#modifier" },
        { "include": "#declaration" },
        { "include": "#function" },
        { "include": "#call" },
        { "include": "#method-call" },
        { "include": "#callable" },
        { "include": "#class" }
      ]
    },
    "keyword": {
      "patterns": [
        {
          "name": "keyword.control.flicker",
          "match": "\\b(?:return|print|error|pass|do|if|else|elif|when)\\b"
        },
        {
          "name": "keyword.operator.flicker",
          "match": "\\b(?:is|in|not|and|or|shl|shr)\\b"
        },
        {
          "name": "keyword.operator.range.flicker",
          "match": "\\.\\.<?"
        },
        {
          "name": "keyword.operator.bitwise.flicker",
          "match": "(\\||&|\\^|~)"
        },
        {
          "name": "keyword.operator.arithmetic.flicker",
          "match": "(\\+|\\-|\\*{1,2}|\/|%)"
        },
        {
          "name": "keyword.operator.comparison.flicker",
          "match": "(==|!=|<=|>=|<|>)"
        },
        {
          "name": "keyword.operator.assignment.flicker",
          "match": "(=)"
        }
      ]
    },
    "keyword-loop": {
      "match": "\\b(each|for|while|break|continue)\\b(?:\\s*(:)\\s*(\\w+))?",
      "captures": {
        "1": { "name": "keyword.control.flicker" },
        "2": { "name": "punctuation.separator.label.flicker" },
        "3": { "name": "entity.name.label.flicker"}
      }
    },
    "use": {
      "name": "meta.use.flicker",
      "begin": "^(use)",
      "beginCaptures": {
        "1": { "name": "keyword.other.flicker" }
      },
      "patterns": [
        {
          "match": "(->)\\s*(\\w+)",
          "captures": {
            "1": { "name": "keyword.operator.alias.flicker" },
            "2": { "name": "meta.use.alias.flicker" }
          }
        }
      ],
      "end": "(\\bfrom\\b|(?=\"))",
      "endCaptures": {
        "0": { "name": "keyword.other.flicker" }
      }
    },
    "constant": {
      "patterns": [
        {
          "name": "constant.language.flicker",
          "match": "\\b(True|False|None)\\b"
        },
        {
          "name": "constant.numeric.flicker",
          "match": "\\b(0x[0-9A-Fa-f]*|[0-9_]+(\\.?[0-9_]*)?)\\b"
        },
        {
          "name": "constant.numeric.hexadecimal.flicker",
          "match": "(0x[0-9A-Fa-f]+)"
        }
      ]
    },
    "variable": {
      "patterns": [
        {
          "name": "variable.language.flicker",
          "match": "\\b(this|super)\\b"
        }
      ]
    },
    "type": {
      "name": "entity.name.type.flicker",
      "match": "\\b([A-Z]\\w*)\\b"
    },
    "modifier": {
      "name": "storage.modifier.flicker",
      "match": "\\b(static|attribute)\\b"
    },
    "declaration": {
      "patterns": [
        {
          "name": "storage.type.variable.flicker",
          "match": "\\b(var)\\b"
        },
        {
          "name": "storage.type.value.flicker",
          "match": "\\b(val)\\b"
        },
        {
          "name": "storage.type.function.flicker",
          "match": "\\b(fun)\\b"
        }
      ]
    },
    "function": {
      "match": "\\b(fun)\\b\\s+`?(\\w+)`?",
      "captures": {
        "1": { "name": "storage.type.function.flicker" },
        "2": { "name": "entity.name.function.flicker" }
      },
      "patterns": [
        {
          "name": "meta.parameters.function.flicker",
          "begin": "\\(",
          "end": "\\)",
          "patterns": [
            {
              "name": "variable.parameter.function.flicker",
              "match": "\\w+"
            }
          ]
        }
      ]
    },
    "call": {
      "match": "`?\\b(?:([A-Z]\\w*)|(\\w+))\\b`?\\s*(?=\\(|{)",
      "captures": {
        "1": { "name": "entity.name.type.flicker" },
        "2": { "name": "entity.name.function.flicker" }
      }
    },
    "method-call": {
      "match": "\\.`?(\\w+)`?\\s*(?=\\(|{)",
      "captures": {
        "1": { "name": "entity.name.function.flicker" }
      }
    },
    "callable": {
      "match": "::\\s*`?(\\w+)`?\\s*(?:\\((\\d+)\\))?",
      "captures": {
        "1": { "name": "entity.name.function.flicker" },
        "2": { "name": "variable.parameter.flicker" }
      }
    },
    "class": {
      "match": "\\b(class)\\s+`?(\\w+)`?\\s*(?:(<)\\s*`?(\\w+)`?)?\\s*(\\;|\\[\\s*\\])?",
      "captures": {
        "1": { "name": "storage.type.class.flicker" },
        "2": { "name": "entity.name.type.class.flicker" },
        "3": { "name": "keyword.operator.inherit.flicker" },
        "4": { "name": "entity.name.type.class.flicker" },
        "5": { "name": "punctuation.terminator.class" }
      }
    }
  }
}